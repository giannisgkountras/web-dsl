{% macro render_element(element, row_parent=True) %}
    {% if element.__class__.__name__ == 'Row' %}
            {% if row_parent %}
                <div className="row row-parent">
            {% else %}
                <div className="row row-child">
            {% endif %}
                {% for child in element.elements %}
                    {{ render_element(child, row_parent=False) }}
                {% endfor %}
            </div>
        
    {% elif element.__class__.__name__ == 'Column'%}
            <div className="column">
                {% for child in element.elements %}
                    {{ render_element(child, row_parent=False) }}
                {% endfor %}
            </div>
    {% elif element.__class__.__name__ == 'ComponentRef'%}
        {{ render_element(element.ref) }}
    
    {% elif element.isComponent %}
        
        {% set sourceOfContent = element.sourceOfContent %}
        {% set restData={}%}
        {% set dbData={}%}
        {% set topic=None%}
        {% if sourceOfContent=="rest" %}
            {% set restData = {
                "name": element.entity.source.connection.name or 'default',
                "path": element.entity.source.path or '',
                "method": element.entity.source.method or 'GET',
                "params": element.entity.source.params or {},
            } %}
        {% elif sourceOfContent=="db" %}
            {% set dbData = {
                "connection_name": element.entity.source.connection.name or 'default',
                "database": element.entity.source.connection.database or '',
                "query": element.entity.source.query or {},
                "filter": element.entity.source.filter or {},
            } %}
        {% elif sourceOfContent=="broker"%}
            {% set topic=element.entity.source.topic %}
        {% endif %}

        {% set type = element.type %}

        {% if type.name=="Gauge"%}
            <Gauge 
                topic={"{{topic}}"} 
                attribute={ {name: "{{type.value.name}}", type: "{{type.value.__class__.__name__}}"  } } 
                sourceOfContent={"{{sourceOfContent}}"} 
                restData={ {{restData}} }
                staticValue={ {{type.value_static}} }
                dbData={ {{dbData}} }
                {% if type.value %}
                    contentPath={ {{type.value}} }
                {% endif %}
            />
        
        {% elif type.name=="LineChart"%}

            <CustomLineChart 
                topic={"{{topic}}"} 
                xLabel={"{{type.xLabel}}"} 
                yLabel={"{{type.yLabel}}"} 
                attributes={[ { name: "{{type.xValue.name}}" ,  type: "{{type.xValue.__class__.__name__}}" },
                    {% for attr in type.yValues %}
                        {
                        name: "{{ attr.name }}",
                        type: "{{ attr.__class__.__name__ }}"
                        },
                    {% endfor %}    
                  ]}
                sourceOfContent={"{{sourceOfContent}}"}
                {% if type.staticData %}
                    xValue={"{{type.xValue_static}}"}
                    yValues={[ {% for item in type.yValues_static %}
                                "{{item}}",
                            {% endfor %}  ]}
                    staticChartData={ [ 
                        {% for group in type.staticData.items %}
                            {   
                                {% for dictItem in group.items %}
                                    "{{ dictItem.name }}": "{{ dictItem.value }}"{% if not loop.last %}, {% endif %}
                                {% endfor %}
                            }{% if not loop.last %}, {% endif %}
                        {% endfor %}
                    ] }
                {% endif %}
            />

        {% elif type.name=="LiveTable"%}
            <LiveTable 
                topic={"{{topic}}"} 
                attributes={[ 
                    {% for attr in type.columns %}
                        {
                        name: "{{ attr.name }}",
                        type: "{{ attr.__class__.__name__ }}"
                        },
                    {% endfor %}    
                ]}
            />

        {% elif type.name=="JsonViewer"%}
            <JsonViewer 
                topic={"{{topic}}"} 
                attributes={[ 
                    {% for attr in type.attributes %}
                        {
                        name: "{{ attr.name }}",
                        type: "{{ attr.__class__.__name__ }}"
                        },
                    {% endfor %}    
                ]}
                sourceOfContent={"{{sourceOfContent}}"} 
                restData={ {{restData}} }
                dbData={ {{dbData}} }
            />

        {% elif type.name=="Alive"%}
            <Alive 
                topic={"{{topic}}"} 
                timeout={ {{type.timeout}} }
            />

        {% elif type.name=="Publish" %}
            {% if type.endpoint %}
                {% set publishRestData = {
                    "path": type.endpoint.path or '',
                    "method": type.endpoint.method or 'POST',
                    "headers":type.endpoint.headers or {},
                    "params": type.endpoint.params or {},
                } %}
            {% else %}
                {% set publishRestData = {} %}
            {% endif %}
            <Publish 
                {% if type.broker %}
                    brokerName={"{{type.broker.name}}"} 
                {% endif %}
                {% if type.endpoint %}
                    apiName={"{{type.endpoint.connection.name}}"} 
                {% endif %}
                {% if type.topic %}
                    destinationTopic={ "{{type.topic}}" }  
                {% endif %}
                {% if type.json %}
                    json={ {{type.json}} }
                {% endif %} 
                restData={ {{publishRestData}} }
            />

        {% elif type.name=="Notification" %}
            <LiveNotification
                type={"{{type.type}}"}
                topic={"{{topic}}"} 
                attribute={ { name: "{{type.message.name}}" ,  type: "{{type.message.__class__.__name__}}"} }
            />

        {% elif type.name=="Image" %}
            <CustomImage 
                topic={"{{topic}}"} 
                source={ { name: "{{type.source.name}}" ,  type: "{{type.source.__class__.__name__}}" } }
                width={ {{type.width}} }
                height={ {{type.height}} }
                sourceOfContent={"{{sourceOfContent}}"} 
                restData={ {{restData}} }    
                sourceStatic={"{{type.source_static}}"}
            />

        {% elif type.name=="Text" %}
            <Text 
                topic={"{{topic}}"} 
                size={ {{ type.size | default(18) }} }
                color={"{{type.color}}"}
                sourceOfContent={"{{sourceOfContent}}"} 
                restData={ {{restData}} }    
                staticContent={"{{type.content_static}}"}
                dbData={ {{dbData}} }
                {% if type.content %}
                    contentPath={ {{type.content}} }
                {% endif %}
            />

        {% elif type.name=="Logs" %}
            <Logs 
                topic={"{{topic}}"} 
                attributes={[ 
                    {% for attr in type.attributes %}
                        {
                        name: "{{ attr.name }}",
                        type: "{{ attr.__class__.__name__ }}"
                        },
                    {% endfor %}    
            ]}/>

        {% elif type.name=="CrudTable" %}
            <CrudTable
                attributes={[ 
                    {% for attr in type.attributes %}
                        {
                        name: "{{ attr.name }}",
                        type: "{{ attr.__class__.__name__ }}"
                        },
                    {% endfor %}    
                ]}
                sourceOfContent={"{{sourceOfContent}}"} 
                restData={ {{restData}} }
                dbData={ {{dbData}} }
            />
        
        {% endif %}

    {% endif %}
{% endmacro %}